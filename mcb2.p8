pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
cls()

--for title screen anim
t = 0

function _init()
	_update = menu_update
	_draw = menu_draw
	--
	music(0)
end

function menu_update()
	t += 1
	if (btn(5)) == true then 
		_update = game_update
	 _draw = game_draw
	 
 end
end

function menu_draw()
	cls()
	for i=1,3 do
  for j0=4,7 do
  j = 7-j0
  col = 7+j
  t1 = t + i*4 - j*2
  y = 38 + j + cos(t1/50)*5
  pal(7,col)
  spr(48+i, 45+i*8, y)
  end
 end
 print("my custom breakout",
    28, 55, 8) 
 print("press x to play",
    34, 70, 13) 
 spr(8, 52, 90)
	spr(9, 60, 90)
	spr(10, 68, 90)
	print("- a t713 game -",
    34, 102, 10)
end
--****************************
pad={}
	pad.x=52
	pad.y=115
	pad.vxp = 2
	pad.vxn = -2
	pad.friction = 0.9
	pad.stick=true
	
ball={}
	ball.x=pad.x+8
	ball.y=pad.y-5
	ball.dx = 1
	ball.dy = -1
	ball.img=1
	ball.spd=1
	
blink_pad = false
	
life_const = 1
life = life_const
	
function game_update()
	if life>=0 then
		pad_ctrl()
		ball_bhvr()
		
	end
	
	--game over detection
	if life<0 then
		game_over_bhvr()
	end
	
end

function game_draw()
	cls()
	map(0,0,0,0,128,32)
	
	if (blink_pad == true) then
			pal(11,8)
			pal(3,2)
	else
		pal()
	end
	
	if life>=0 then
		ball_disp()
		life_display()
		pad_display()
	end
	
	
	--print("life "..tostr(life))
	
	--game over detection
	if life<0 then
		game_over_disp()
	end
end

function pad_display()
	--draw the 3 sprites
	-- composing pad
	spr(8,pad.x,pad.y,3,1)
	
end

function pad_ctrl()
	if (btn(0)) pad.x += pad.vxn
	if (btn(1)) pad.x += pad.vxp
	
	if (btn(4))==true and pad.stick==true then
		pad.stick=false	
	end
	
	--collisions behavior
	if pad.x<=7 then pad.x=7 end
	if pad.x>=121-(8*3) then pad.x=121-(8*3) end
end

--display the ball
function ball_disp()
	spr(ball.img,ball.x,ball.y)
end

function ball_bhvr()
	--ball check if sticked
	if pad.stick ==true then
		ball.x=pad.x+8
		ball.y=pad.y-5
	else --else move
		ball.x += (ball.dx * ball.spd)
		ball.y += (ball.dy * ball.spd)
	end
	
	--collisions walls
	if (ball.x>=113) then
		ball.x = 112
		ball.dx = 0-(ball.dx)
		sfx(0)
	end
	if (ball.y<=14) then
		ball.y = 15
		ball.dy = 0-(ball.dy)
		sfx(0)
	end
	if (ball.x<=6) then
		ball.x = 7
		ball.dx = 0-(ball.dx)
		sfx(0)
	end
	
	--collision bottom void
	if (ball.y>=126) then
		life_system()
	end	
	
	--collision pad top
	if (ball.x>=pad.x) and
				(ball.x<=(pad.x+24)) and
				(ball.y>=pad.y-6) and
				(ball.y<=pad.y+8) and
				(pad.stick==false) then
			ball.y=pad.y-5
			ball.dy = 0-(ball.dy)
			blink_pad=true	
			sfx(3)
	else
		blink_pad=false
	end
	
	--collision pad left
	if ((ball.x)>=(pad.x+1)) and
				(ball.y >= pad.y+3) and
				(ball.y >= pad.y+7) then
		ball.dx = 0-(ball.dx)
	end
	--collision pad bottom
	
	
	--collision pad right
	
	
	
	
end

function life_system()
	sfx(2)
	--reset values pad & ball
	pad.stick=true
	pad.x=52
	pad.y=115
	ball.x=pad.x+8
	ball.y=pad.y-5
	ball.dx = 1
	ball.dy = -1
	
	-- -1 life
	life -= 1
	
	
end

function game_over_disp()
	rectfill(9,50,118,77,0)
	line(9,50,118,50,7)
	line(9,77,118,77,7)
	line(9,50,9,76,7)
	line(118,50,118,76,7)
	
	--print game over 
	--et press x to reset
	print("game over!",46,53,8)
	print("press x to restart",29,61,7)
	spr(16,60,68)
end

function game_over_bhvr()
	if (btn(5)) then
		reset_game()
	end
end

function life_display()
	for i=1,life do
		spr(32,(96+(i*8)),0)
	end
end

function reset_pad_and_ball()
	--reset values pad & ball
	pad.stick=true
	pad.x=52
	pad.y=115
	ball.x=pad.x+8
	ball.y=pad.y-5
	ball.dx = 1
	ball.dy = -1
end

function reset_game()
 life = life_const
 _init()
	reset_pad_and_ball() 
end
__gfx__
00000000000000002888888228888882022222222222222222222220222222220000000000000000000000001011110100000000000000000000000000000000
00000000000660002888888228888882288888888888888888888882288668880000000000000000000000000111111000000000000000000000000000000000
0070070000daa600288888822888888228888888888888888888888228daa688009994063bbbbbb3604999001001100100000000000000000000000000000000
000770000da7a96028888882278888822888888888888888888888822da7a9680997745773333337754779901110011100000000000000000000000000000000
000770000daaa96028888882278888822888888888888888888888822daaa9680499925666dddd66652999401101101100000000000000000000000000000000
0070070000d99600288888822788888228888888888888888888888228d99688024442511d1111d1152444201110011100000000000000000000000000000000
00000000000dd0002888888228778882288888888888888888888882288dd888002222055d5555d5502222001001100100000000000000000000000000000000
00000000000000002888888202222220288888822222222228888882288888820000000000000000000000000111111000000000000000000000000000000000
60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000a000d6660008888880099999900cccccc0077777700aaaaaa00bbbbbb00222222000000000000000000000000000000000000000000000000000000000
0a0060000dc7c16008788820097999400c7ccc10077777c00a7aaa900b7bbb300272221000000000000000000000000000000000000000000000000000000000
0009a0000dccc16008888820099999400ccccc10077777c00aaaaa900bbbbb300222221000000000000000000000000000000000000000000000000000000000
006906060dcc116008888820099999400ccccc10077777c00aaaaa900bbbbb300222221000000000000000000000000000000000000000000000000000000000
000600000dc1116008888820099999400ccccc10077777c00aaaaa900bbbbb300222221000000000000000000000000000000000000000000000000000000000
0600000000dddd0008222220094444400c11111007ccccc00a9999900b3333300211111000000000000000000000000000000000000000000000000000000000
000060a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08808800068882600eeeeee006666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888780d87888260e7eeed006766650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888880d88888260eeeeed006666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888800d88888260eeeeed006666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00888000d88882260eeeeed006666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000800000d2222d00eddddd006555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000dddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770007707777777077777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777077707700000077000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777707700000077777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770707707700000077000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770007707700000077000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770007707777777077777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0405050505050505050505050505050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b1212121212121212121212120b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b1213131313131313131313120b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b1217142223181823221417120b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b1216161616161616161616120b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b1212121212121212121212120b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020b0b0b0b0b0b0b0b0b0b0b0b0b0b0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
030b0b0b0b0b0b0b0b0b0b0b0b0b0b0300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0001000000000090003d0503d0503d0503d050350500a000090000900009000090000900009000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000e0500e05000000100500e0500e0500000000000000001c0501c050000001a0501a050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00040000356503b6503f6503c6502c6501a650116500b650076500165001650016500450000000000000000000000000000000015400164001840018400000000000000000000000000000000000000000000000
00020000020500205002050020500205002050160501b05014050110500e050250502f05000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 01424344

